{{#partial "body"}}
<main class="flex justify-center items-center h-screen flex-col">
    <h1 class="text-3xl mb-10">Please sign up</h1>
    <form method="post" class="card flex-shrink-0 w-full max-w-sm shadow-2xl bg-base-100">
        <div class="card-body">
            <div class="form-control">
                <label class="label" for="username">
                    <span class="label-text">username</span>
                </label>
                <input class="input input-bordered {{#if error}}input-error{{/if}}" type="text"
                       id="username"
                       name="username" value="{{username}}">
            </div>
            <div class="form-control">
                <label class="label" for="email">
                    <span class="label-text">email</span>
                </label>
                <input class="input input-bordered {{#if error}}input-error{{/if}}" type="email"
                       id="email"
                       name="email" value="{{email}}">
            </div>
            <div class="form-control">
                <label class="label" for="password">
                    <span class="label-text">password</span>
                </label>
                <div class="relative w-full">
                    <div class="absolute inset-y-0 right-0 flex items-center px-2">
                        <input class="hidden js-password-toggle" id="toggle" type="checkbox"/>
                        <label class="bg-gray-300 hover:bg-gray-400 rounded opacity-50  px-2 py-1 text-sm text-gray-600
                        font-mono cursor-pointer js-password-label" for="toggle">show</label>
                    </div>
                    <input class="input input-bordered w-full js-password {{#if error}}input-error{{/if}}"
                           type="password"
                           id="password"
                           name="password">
                </div>
            </div>
            <div class="form-control">
                <label class="label" for="repeat-password">
                    <span class="label-text">repeat password</span>
                </label>
                <input class="input input-bordered js-repeat-password {{#if error}}input-error{{/if}}" type="password"
                       id="repeat-password">
            </div>
            <span id="error-text" class="text-error">{{error}}</span>
            <div class="form-control mt-6">
                <button type="submit" class="btn btn-primary">Sign up</button>
            </div>
        </div>
    </form>
</main>
<script>
    const passwordToggle = document.querySelector('.js-password-toggle')
    passwordToggle.addEventListener('change', function () {
        const password = document.querySelector('.js-password');
        const repeatPassword = document.querySelector('.js-repeat-password'),
            passwordLabel = document.querySelector('.js-password-label')
        if (password.type === 'password' && repeatPassword.type === 'password') {
            password.type = 'text'
            repeatPassword.type = 'text'
            passwordLabel.innerHTML = 'hide'
        } else {
            password.type = 'password'
            repeatPassword.type = 'password'
            passwordLabel.innerHTML = 'show'
        }
        password.focus();
        repeatPassword.focus();
    })

    function submit(event) {
        const password = document.querySelector('input[name="password"]').value;
        const repeatPassword = document.querySelector('#repeat-password').value;
        if (password !== repeatPassword) {
            event.preventDefault();
            document.querySelector('#error-text').innerText = "passwords don't match";
            document.querySelectorAll('.form-control input[type="password"]').forEach(function (elem) {
                elem.classList.add('input-error')
            })
        }
    }

    document.querySelector("form").addEventListener("submit", submit)
    const inputs = document.querySelectorAll("input")
    for (const input of inputs) {
        input.addEventListener("input", function () {
            document.querySelector('#error-text').innerText = "";
            document.querySelectorAll('.form-control input').forEach(function (elem) {
                elem.classList.remove('input-error')
            })
        })
    }
</script>
{{/partial}}
{{> base}}